@page "/"
@using Client.Pages.Components
@using ComposedHealthBase.Shared.Interfaces
@using Microsoft.AspNetCore.Authorization
@using Shared.DTOs.CRM
@using Client.Pages.Components.Calendar
@using Shared.DTOs.Scheduling
@inject IHttpClientFactory HttpClientFactory
@* @attribute [Authorize] *@

<PageTitle>Diary</PageTitle>

<MudText Typo="Typo.h1">Diary</MudText>

<MultiResourceCalendar Resources="@Clinicians" />

@code {
    private IEnumerable<ICalendarResource> Clinicians { get; set; } = new List<ClinicianDto>();
    private HttpClient? httpClient;

    protected override async Task OnInitializedAsync()
	{
		try
		{
			httpClient = HttpClientFactory.CreateClient("api");

			Clinicians = await httpClient.GetFromJsonAsync<IEnumerable<ClinicianDto>>("api/clinician/getallclinicianswithschedules");
		}
		catch (Exception ex)
		{
			Console.WriteLine($"Error fetching Clinician data: {ex.Message}");
		}
	}
}